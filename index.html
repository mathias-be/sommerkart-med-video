<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sommerkart</title>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>

<style>
:root { --header:56px; }

body {
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background:#000;
}

/* HEADER */
header {
  height:var(--header);
  background:#111;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 12px;
}
header h1 {
  margin:0;
  font-family:Georgia,serif;
}

/* MAP */
#app {
  height:calc(100vh - var(--header));
  position:relative;
}
#map {
  width:100%;
  height:100%;
}

/* MAP BUTTONS */
#map-controls {
  position:absolute;
  top:12px;
  right:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  z-index:1000;
}
#map-controls button {
  background:#fff;
  border:none;
  padding:6px 10px;
  border-radius:999px;
}

/* EMOJI MARKERS */
.emoji-icon {
  width:48px;
  height:48px;
  font-size:28px;
  background:#fff;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 4px rgba(0,0,0,.4);
}

/* VIDEO CARD */
#video-card {
  position:absolute;
  left:0;
  right:0;
  bottom:-100%;
  background:#111;
  color:#fff;
  border-radius:16px 16px 0 0;
  padding:12px;
  transition:bottom .3s ease;
  z-index:2000;
}
#video-card.active {
  bottom:0;
}
#video-card h3 {
  margin:0 0 8px;
}
#video-card video {
  width:100%;
  max-height:45vh;
  border-radius:12px;
  background:#000;
}
#close-video {
  position:absolute;
  top:8px;
  right:12px;
  font-size:20px;
  background:none;
  border:none;
  color:#fff;
}
</style>
</head>

<body>
<header>
  <h1>Sommerkart</h1>
  <a href="https://www.f-b.no/" target="_blank">
    <img src="https://www.f-b.no/favicon.ico" width="28" />
  </a>
</header>

<div id="app">
  <div id="map"></div>

  <div id="map-controls">
    <button id="btn-home">üó∫ Hele kartet</button>
    <button id="btn-softis">üç¶ Softis</button>
    <button id="btn-locate">üìç Finn meg</button>
  </div>

  <!-- VIDEO CARD -->
  <div id="video-card">
    <button id="close-video">‚úï</button>
    <h3 id="video-title"></h3>
    <video id="video-player" controls playsinline></video>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const spots = [
  { name:"Glufsa", lat:59.17639, lon:10.88216, video:"glufsa.mp4" },
  { name:"M√¶rrapanna", lat:59.19746, lon:10.79604, video:"maerrapanna.mp4" },
  { name:"Foten", lat:59.17035, lon:10.82661, video:"foten.mp4" },
  { name:"Softis i Nygaardsgata", lat:59.20847, lon:10.94176, video:"softis.mp4" }
];

const map = L.map("map").setView([59.19,10.86],11);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

const videoCard = document.getElementById("video-card");
const videoPlayer = document.getElementById("video-player");
const videoTitle = document.getElementById("video-title");
const closeVideo = document.getElementById("close-video");

function openVideo(spot) {
  videoTitle.textContent = spot.name;
  videoPlayer.src = spot.video;
  videoPlayer.play();
  videoCard.classList.add("active");
}

closeVideo.onclick = () => {
  videoPlayer.pause();
  videoCard.classList.remove("active");
};

spots.forEach(s => {
  const icon = L.divIcon({
    className:"emoji-icon",
    html: s.name.includes("Softis") ? "üç¶" : "‚õ±Ô∏è"
  });

  L.marker([s.lat,s.lon],{icon})
    .addTo(map)
    .on("click",()=>openVideo(s));
});

/* CONTROLS */
btnHome.onclick=()=>map.setView([59.19,10.86],11);
btnSoftis.onclick=()=>{
  const s=spots.find(x=>x.name.includes("Softis"));
  map.setView([s.lat,s.lon],17);
  openVideo(s);
};
btnLocate.onclick=()=>{
  navigator.geolocation.getCurrentPosition(p=>{
    map.setView([p.coords.latitude,p.coords.longitude],15);
  });
};

window.onload=()=>setTimeout(()=>map.invalidateSize(),200);
</script>
</body>
</html>
